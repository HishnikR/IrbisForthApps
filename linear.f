
100 constant DSIZE

CREATE X[] DSIZE CELLS ALLOT
CREATE Y[] DSIZE CELLS ALLOT

VARIABLE PHI 0.0 PHI F!
VARIABLE R 0.0 R F!
VARIABLE PX
VARIABLE PY
VARIABLE SIGMA 6.0 SIGMA F!

PROC P(PHI,R)
  0.0
  DSIZE 0 DO
     X[] I -TH F@ PY F@ F*
     Y[] I -TH F@ PX F@ F* F-
     R F@ F+
     SIGMA F@ FGAUSS
     F+
  LOOP
ENDPROC

VARIABLE PHI0
VARIABLE PHI+
INT PHISTEPS

: >RAD PI F* 180.0 F/ ;

100 TO PHISTEPS
-90.0 >RAD PHI0 F!
1.8 >RAD PHI+ F!

VARIABLE PHIMAX
VARIABLE PHIARGMAX

0 CHART.SHOW

0 CHART.ALIGN.CLIENT
0 0 CHART.ADDSERIES

PROC LOOP_PHI
  0 SERIES.CLEAR
  0.0 PHIMAX F!
  0.0 PHIARGMAX F!
  PHI0 F@ PHI F!
  PHISTEPS 0 DO
    PHI F@
    PHI F@ FCOS PX F!
    PHI F@ FSIN PY F!
    P(PHI,R)
    0 SERIES.FXY

    PHI F@ PHI+ F@ F+ PHI F!
  LOOP
ENDPROC

PROC LOOP_R


ENDPROC


PROC FILL
  DSIZE 0 DO
    I S>F X[] I -TH F!
    I S>F Y[] I -TH F!
  LOOP
ENDPROC

FILL
LOOP_PHI
