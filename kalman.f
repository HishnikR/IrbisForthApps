

100 CONSTANT DATASIZE

CREATE X[] DATASIZE FLOATS ALLOT

INT WINDOW
10 TO WINDOW
INT TIME

50 TO TIME

FLOAT SIGMA
FLOAT SIGMA0
FLOAT EPSILON

1.0 SIGMA0 F!
0.1 EPSILON F!

FLOAT X0

PROC P(X) // F:X-- F: P
  X0 F!
  0.0
  WINDOW 0 DO
    X[] TIME I - -TH F@ X0 F@ F-
    I S>F EPSILON F@ F* SIGMA0 F@ F+ SIGMA F!
    SIGMA F@ FGAUSS F+
  LOOP
ENDPROC

PROC FILLCONST
  datasize 0 DO
    1.0 X[] I -TH F!
  LOOP
ENDPROC

FILLCONST

FLOAT XMIN
FLOAT XMAX
FLOAT XSTEP
INT STEPS

FLOAT PMAX
FLOAT ARGMAX


PROC FINDX
  XMAX F@ XMIN F@ F- STEPS S>F F/ XSTEP F!
  0.0 PMAX F!
  XMIN F@ ARGMAX F!
  XMIN F@ X0 F!
  STEPS 0 DO
    X0 F@ P(X) FDUP PMAX F@ F> IF
      FDUP PMAX F! X0 F@ ARGMAX F!
    THEN FDROP
    X0 F@ XSTEP F@ F+ X0 F!
  LOOP

ENDPROC

0.0 XMIN F!
10.0 XMAX F!
100 TO STEPS

CR
FINDX ARGMAX F@ F.


